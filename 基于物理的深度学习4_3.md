# 到目前为止一切顺利 - 初步讨论

## 目录
- 与现有数值方法的兼容性
- 离散化
- 效率
- 效率（续）
- 总结

在上一节中，我们看到了使用物理残差作为软约束的重构示例（变体2，即PINNs），以及使用可微分物理（DP）求解器的重构示例。虽然这两种方法都可以为类似的逆向问题找到最小化器，但获得的解以及我们从每种公式得到的非线性优化问题的行为都有显著差异。下面我们将更详细地讨论这些差异，并将从 **Burgers Optimization with a PINN** 和 **Burgers Optimization with a Differentiable Physics Gradient** 中的 Burgers 案例行为得出的结论与外部研究论文 [HKT19] 的观察结果相结合。

## 与现有数值方法的兼容性

非常明显的是，PINN 的实现相当简单，这是一个积极的方面，但同时它与通常用于求解诸如 Burgers 方程之类的 PDE 的“典型”离散化和求解方法有很大不同。导数通过神经网络计算，因此依赖于相当精确的解表示来为优化问题提供良好的方向。

另一方面，DP 版本本质上依赖于一个融入学习过程的数值求解器。因此，它需要对当前问题进行离散化，并且通过这种离散化可以采用现有的、可能功能强大的数值技术。这意味着可以用已知且可控的精度来评估解和导数，并且可以高效地评估。

## 离散化

对合适离散化的依赖需要对所考虑的问题有一定的理解和知识。次优的离散化可能会阻碍学习过程，或者在 worst case（最坏情况）下导致训练运行发散。然而，鉴于存在大量针对各种物理问题的稳定求解器的理论和实践成果，这通常不是一个不可逾越的障碍。

另一方面，PINN 方法不需要先验地选择离散化方案，因此看起来是“无离散化的”。然而，这乍一看只是一个优势。到目前为止，研究人员正试图将离散化“重新整合”到 PINN 训练中。通常，PINN 不可避免地会在计算机中产生解，因此必须对问题进行离散化。它们在训练过程中构建这种离散化，这种方式受制于底层的非线性优化，并且不易从外部控制。因此，最终的精度取决于训练在多大程度上成功地估计了实际用例中问题的复杂性，以及训练数据在多大程度上近似了解未知区域。

例如，正如 Burgers 示例所证明的那样，PINN 解通常在时间上反向传播信息方面存在显著困难。这与方法的效率密切相关。

## 效率

PINN 方法还导致本质上更困难的训练任务，从而引起收敛问题。PINN 通常执行解的局部采样和校正，这意味着以权重更新形式进行的校正通常也是局部的。在空间和时间上满足边界条件的速度可能相应地很慢，导致实践中训练运行时间很长。

DP 方法中精心选择的离散化可以纠正这种行为，并提供改进的梯度信息流。同时，对计算网格的依赖意味着可以非常快速地获得解。给定一个插值方案或一组基函数，可以在计算网格的一个非常局部的邻域内对空间或时间上的任何点进行解采样。最坏情况下，这可能会导致轻微的内存开销，例如，通过重复存储解的大部分恒定值。

另一方面，对于使用全连接网络的 PINN 表示，我们需要对整个网络中潜在的大量值进行一次完整的传递，才能获得单个点处的解样本。该网络实际上需要编码完整的高维解，其大小同样决定了导数计算的效率。

## 效率（续）

话虽如此，由于 DP 方法可以覆盖更大的解流形，这些流形的结构通常也很难学习。例如，当使用大量迭代（即对未来进行长前瞻）训练网络时，这通常代表一个比短前瞻更难学习的信号。

因此，这些训练运行不仅每次 NN 迭代需要更多的计算资源，而且通常需要更长时间才能收敛。关于资源，每次前瞻计算可能需要大量的模拟步骤，并且反向传播步骤通常需要相似数量的资源。因此，虽然它们有时可能看起来成本高昂且收敛缓慢，但这通常是由于需要学习的信号更复杂造成的。

## 总结

下表总结了物理信息（PI）和可微分物理（DP）方法的这些优缺点：

| 方法                            | ✅ 优点                                          | ❌ 缺点                                                       |
| :------------------------------ | :---------------------------------------------- | :----------------------------------------------------------- |
| **PI** <br/> (物理信息神经网络) | - 通过反向传播获得解析导数。<br/>- 易于实现。   | - NN 评估昂贵，且导数计算成本非常高。<br/>- 与现有数值方法不兼容。<br/>- 无法控制离散化。 |
| **DP** <br/> (可微分物理)       | - 利用现有数值方法。<br/>- 高效评估模拟和导数。 | - 实现更复杂。<br/>- 需要理解问题以选择合适的离散化。        |

总结来说，两种方法都绝对有趣，并且潜力巨大。有许多更复杂的扩展和算法修改可以改变和改进我们为双方讨论的各种负面方面。

然而，截至本文撰写时，PINN 方法在性能以及与现有数值方法的兼容性方面存在明显的局限性。因此，当对手头的问题有了解时（这通常是我们选择合适 PDE 模型来约束学习过程的情况），采用可微分物理求解器来训练神经算子可以显著改善训练过程以及获得的解的质量。

所以，接下来我们将专注于 DP 变体，并在接下来的章节中用更复杂的场景来说明它们的能力。首先，我们将考虑一个为瞬态流体模拟非常高效地计算时空梯度的案例。